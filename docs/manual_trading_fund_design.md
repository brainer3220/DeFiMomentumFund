# 매뉴얼 트레이딩 펀드 설계

본 문서는 수동 거래형 DeFi 펀드의 구조와 수수료 모델을 요약합니다. 세부 내용은 다음과 같습니다.

## 1. 기본 전제 및 역할 정의

| 구분 | 내용 |
| ---- | ---- |
| **펀드 구조** | ① 단일 `Vault` 스마트컨트랙트에 모든 자산 예치<br>② Vault 지분은 `FUND-SHARE` ERC-20 토큰으로 발행·소각 |
| **핵심 역할** | *관리자(Manager)* – 투자 실행(수동 거래)·전략 변경 권한 보유<br>*감시자(Guardian)* – 다중서명으로 비상정지·업그레이드 승인<br>*참여자(LP)* – 입·출금으로 펀드 참여, `FUND-SHARE` 보유 |
| **거래 방식** | 관리자가 직접 DEX·CEX·브릿지 호출 트랜잭션을 제출 → Vault 자산 이동·교환 수행. 모든 명령은 컨트랙트 함수(`executeTrade()`)로 호출하므로 자금은 항상 Vault 안에 머무름. |

## 2. 지분 발행·상환 메커니즘

1. **입금(Deposit)**
   - 사용자가 자산 `X`를 `deposit(X, amount)` 호출 → `FUND-SHARE` 토큰 `S` 발행
   - 발행식: `S = amount / P`, 단 `P` = 직전 지분당 순자산가치(NAV)
   - NAV 산출은 체인링크 등 다중 오라클 가격을 이용해 실시간 계산
2. **인출(Withdraw)**
   - 사용자가 `redeem(S)` 호출 → 지분 비율만큼 보유 자산 pro-rata 지급 후 `S` 소각
   - Vault 잔고 중 유동성 낮은 자산은 교환 규칙(예: 10% 이상은 스테이블코인으로 대체) 적용

## 3. 수수료 체계 (Manual Trading Fund 전용)

- **운용 수수료:** 연 2%를 블록 단위로 누적해 관리자가 호출 시 지분으로 발행
- **성과 수수료:** HWM(High-Water Mark) 대비 초과 수익의 20%를 지분으로 정산
- **입·출금 스프레드:** 0.10%를 즉시 징수해 운영비와 가스비로 활용
- **가스비 환급:** `claimGas()` 호출 시 지난 기간 사용 가스비를 별도 버퍼에서 보상
- **프로토콜 수수료:** 성과 수수료 중 일부(예: 2%p)를 DAO 재무금으로 분배

## 4. 회계·정산 모듈 개요

- **Position Registry:** 토큰·LP·NFT 등 포지션 구조체 관리
- **NAV Oracle:** 여러 가격 소스를 이용해 모든 포지션을 USD 기준으로 평가
- **FeeAccumulator:** 미수 수수료를 저장하는 구조체
- **GasTracker:** 거래 실행 시 사용된 가스를 기록
- **Crystallizer:** 에폭 종료(예: 30일) 후 누구나 `crystallize()` 호출해 수수료 정산 가능
- **EmergencyGuard:** Guardian 멀티시그가 `pauseVault()`로 비상 정지 가능

더 자세한 시뮬레이션 및 수치 예시는 초기 설계 문서를 참고하세요.
